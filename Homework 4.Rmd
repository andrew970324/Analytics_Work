---
title: "Homework 4 - Healthcare and Text Analytics"
author: "Andrew Wang"
date: "5/31/2022"
output:
  pdf_document: default
  html_document: default
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Diabetes Risk Prediction

## Part 1: Understanding the data

### a)

```{r}
diabetes = read.csv("C:/Users/andre/Documents/Operations_Analytics/nhanes-diabetes-final.csv")
head(diabetes)
nrow(diabetes)
```

### b)

```{r}
table(diabetes$Diabetes)
357/5406
```
### c)

```{r}
have_diabetes = subset(diabetes, Diabetes==1)
table(diabetes$Education)
table(have_diabetes$Education)
eighth = 43/283
ninth_eleventh = 48/693
high_school = 82/1193
some_college = 116/1856
college_grad = 68/1738
print(paste("8th Grade:", eighth))
print(paste("9-11 Grade:", ninth_eleventh))
print(paste("High School:", high_school))
print(paste("Some College:", some_college))
print(paste("College Grad:", college_grad))
```
### d)

```{r}
diabetes$BMI = diabetes$Weight / (diabetes$Height/100)^2
obesity = subset(diabetes, BMI > 30)
table(obesity$Diabetes)
222/1803
```
## Part 2: A first logistic regression model

### a)

```{r}
library(caTools)
set.seed(88)
spl = sample.split(diabetes$Diabetes, SplitRatio = 0.7)

# Now split the data:
diabetes.train = subset(diabetes, spl == TRUE)
diabetes.test = subset(diabetes, spl == FALSE)

# Our first model will be a logistic regression model.
diabetes.glm = glm(Diabetes ~ Gender+Age+HHIncome+HomeOwn, data = diabetes.train, family = "binomial")

# Examine the coefficients
summary(diabetes.glm)
```

## Part 3: A richer logistic regression model

### a)

```{r}
# Let's now make predictions on our test set.
diabetes2.glm = glm(Diabetes ~ ., data = diabetes.train, family = "binomial")
diabetes.predict = predict( diabetes2.glm, newdata = diabetes.test, type = "response")

# We are going to take our predictions, and threshold them according to the 
# threshold of 0.5. 
# Confusion matrix:
confMat = table( diabetes.test$Diabetes , diabetes.predict > 0.5 )
confMat

# Calculate the accuracy:
accuracy = sum( diag(confMat)) / nrow(diabetes.test)
accuracy
```
### b)

Excitement is unwarranted because although the accuracy was high, this is due to us classifying nearly all cases as false and barely any as true. Therefore, while we predicted a large amount of true negatives, we weren't able to predict any true positives correctly in our model.













